<html>
  <title>Digital Mirror</title>
  <head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.4.2/handlebars.min.js" integrity="sha256-oh7N5nthuhldTk8/34Za7FXv3BkeVN9vAnYk/pLfC78=" crossorigin="anonymous"></script>
    <script src="./connectAccounts.js"></script>
  </head>
  <body>

    <div id="content">
      <!-- TODO add a fancy loading spinner or some shit like that. -->
      LOADING, PLEASE WAIT
    </div>
    <script id="content-template" type="text/x-handlebars-template">
      {{#each services}}
        <div>
          <h1>Connect your {{this.name}} account</h1>
          <img width="60px" src="{{this.iconUrl}}">
          {{#if this.authorizationCode}}
            <button class="btn btn-outline-danger" onclick="sessionStorage.removeItem('{{this.codeId}}'); window.location.href = REDIRECT_URL">
              Click here to disconnect your account
            </button>
          {{else}}
            <button class="btn btn-success" onclick="window.location.href = '{{this.oauthUrl}}'">
              Click here to connect your account
            </button>
          {{/if}}
        </div>
      {{/each}}

      {{#if accountConnected}}
        <button class="btn btn-info" onclick="analyzeData()">
          Analyze my data!
        </button>
      {{else}}
        <button disabled class="btn btn-outline-info">
          You must connect at least one account before you can analyze your data.
        </button>
      {{/if}}
    </script>
  </body>
</html>
